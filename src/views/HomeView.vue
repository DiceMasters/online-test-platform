<script setup lang="ts">
import { ref, onBeforeMount } from 'vue'
import { useRouter } from 'vue-router'
import {
  NCard,
  NButton
} from 'naive-ui'

const router = useRouter()

const step = ref(1)
const jokeCleared = ref(false)

onBeforeMount(() => {
  const isIntroSkip = localStorage.getItem('skip-intro')

  if (isIntroSkip && isIntroSkip === 'true') {
    router.push('/menu')
  }
})

function onUpdateStep (s: number, clearJoke?: boolean) {
  step.value = s

  if (clearJoke) {
    jokeCleared.value = true
  }
}

function onSubmit () {
  router.push('/menu')

  localStorage.setItem('skip-intro', 'true')
}
</script>

<template>
  <div class="v-home">
    <div class="v-home__content">
      <div class="v-home__body">
        <transition-group name="list">
          <n-card
            class="v-home__intro"
            title="–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é, –≤—ã –ø–æ–ø–∞–ª–∏!"
            key="step1"
          >
            <n-button @click="onUpdateStep(2)">
              –í–∞—É, –∫—É–¥–∞?
            </n-button>
          </n-card>

          <n-card
            v-show="step >= 2"
            class="v-home__intro"
            title="–ù–∞ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –Ω–∞–≤—ã–∫–æ–≤ –≤ —Å—Ñ–µ—Ä–µ –≤–µ—Ä—Å—Ç–∫–∏ –≤–µ–± –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π"
            key="step2"
          >
            <n-button @click="onUpdateStep(3)">
              –ó–≤—É—á–∏—Ç –∏–Ω—Ç—Ä–∏–≥—É—é—â–µ...
            </n-button>
          </n-card>

          <n-card
            v-show="step >= 3 && !jokeCleared"
            class="v-home__intro"
            title="–ê —Ö—É–ª–∏ —Ç—ã —Ö–æ—Ç–µ–ª(–∞), —Å–µ–π—á–∞—Å –º—ã –º–∏–≥–æ–º —Ä–∞—Å–∫–∏–¥–∞–µ–º —Ç–µ–±—è –ø–æ —Ñ–∞–∫—Ç–∞–º –≤–æ–ø—Ä–æ—Å–∞–º–∏ –ø—Ä–æ –ø–æ–ª–æ—Ç–µ–Ω—Ü–µ, –¥–≤–∞ —Å—Ç—É–ª–∞ –∏ –≤–∏–ª–∫—É"
            key="step3"
          >
            <n-button @click="onUpdateStep(4)">
              –ß–µ –∑–∞?
            </n-button>
          </n-card>

          <n-card
            v-show="step >= 4 && !jokeCleared"
            class="v-home__intro"
            title="–ú–∏–Ω—É—Ç—É..."
            key="step4"
          >
            <n-button @click="onUpdateStep(5, true)">
              ...
            </n-button>
          </n-card>

          <n-card
            v-show="step >= 5 && jokeCleared"
            class="v-home__intro"
            title="–¢–µ–±–µ –ø—Ä–µ–¥—Å—Ç–æ–∏—Ç —Å–¥–∞—Ç—å 4 —Ç–µ—Å—Ç–∏—Ä–æ–≤–æ—á–Ω—ã—ã—Ö —ç–∫–∑–∞–º–µ–Ω–∞, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∫–∞–∂—É—Ç —Ç–≤–æ–π —É—Ä–æ–≤–µ–Ω—å –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ —Å—Ç–∞–∂–∏—Ä–æ–≤–∫–∞–º –≤ –∫–∞—á–µ—Å—Ç–≤–µ HTML-–≤–µ—Ä—Å—Ç–∞–ª—å—â–∏–∫–∞"
            key="step5"
          >
            <n-button @click="onUpdateStep(6)">
              4 —Ç–µ—Å—Ç–∞, –∑–≤—É—á–∏—Ç –ª–µ–≥–∫–æ
            </n-button>
          </n-card>

          <n-card
            v-show="step >= 6 && jokeCleared"
            class="v-home__intro"
            title="–ù–µ —Ä–∞—Å–ª–∞–±–ª—è–π—Å—è, –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –º—ã—ã –∑–∞–∫–æ–Ω—á–∏–º –Ω–∞—à –¥–∏–∞–ª–æ–≥ —Ç–µ–±–µ –ø—Ä–µ–¥—Å—Ç–æ–∏—Ç —Ä–µ—à–∏—Ç—å, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ç—ã –≥–æ—Ç–æ–≤(–∞) –∫ –¥–∞–Ω–Ω–æ–º—É —Ç–µ—Å—Ç—É, —è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—é —Ç–µ–±–µ –∫–∞—Ç–∞–ª–æ–≥ —Ç–µ—Å—Ç–æ–≤, –º–æ–∂–µ—à—å –Ω–∞—á–∏–Ω–∞—Ç—å —Å –ª—é–±–æ–≥–æ..."
            key="step6"
          >
            <n-button @click="onUpdateStep(7)">
              –î–∞–ª–µ–µ
            </n-button>
          </n-card>

          <n-card
            v-show="step >= 7 && jokeCleared"
            class="v-home__intro"
            title="–ù–∞ —Å—Ç–∞—Ä—Ç–æ–≤–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Ç—ã —É–≤–∏–¥–∏—à—å —Å–ø–∏—Å–æ–∫ —Å—Å—ã–ª–æ–∫ –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∫ —Ç–µ—Å—Ç—É, –∫—Ä–∞–π–Ω–µ —Å–æ–≤–µ—Ç—É—é —Ç–µ–±–µ –ø—Ä–æ–π—Ç–∏—Å—å –ø–æ –∫–∞–∂–¥–æ–π —Å—Å—ã–ª–∫–µ –∏ —É–∑–Ω–∞—Ç—å —á—Ç–æ —Ç–æ –Ω–æ–≤–æ–µ, –ª–∏–±–æ –≤—Å–ø–æ–º–Ω–∏—Ç—å —É–∂–µ –≤—ã—É—á–µ–Ω–Ω–æ–µ"
            key="step7"
          >
            <n-button @click="onUpdateStep(8)">
              –î–∞–ª–µ–µ
            </n-button>
          </n-card>

          <n-card
            v-show="step >= 8 && jokeCleared"
            class="v-home__intro"
            title="–¢–∞–∫–∂–µ —Ö–æ—á—É –Ω–∞–ø–æ–º–Ω–∏—Ç—å, —á—Ç–æ –∫–∞–∫ —Ç–æ–ª—å–∫–æ —Ç–µ—Å—Ç –Ω–∞—á–Ω–µ—Ç—Å—è, –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è —Ç–∞–π–º–µ—Ä, –Ω–µ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–π –≤–∞—Å –≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏, –Ω–æ –∫–æ—Ç–æ—Ä—ã–π —Ç–∞–∫ –∏–ª–∏ –∏–Ω–∞—á–µ –±—É–¥–µ—Ç –≤–ª–∏—è—Ç—å –Ω–∞ –∏—Ç–æ–≥–æ–≤—É—é –æ—Ü–µ–Ω–∫—É –≤–∞—Å –ø—Ä–æ–≤–µ—Ä—è—é—â–∏–º"
            key="step8"
          >
            <n-button @click="onUpdateStep(9)">
              –ë–æ–∂–µ—á–∫–∏ –±–æ–∂–µ —á—Ç–æ –∑–∞ —Ç–∞–π–º–µ—Ä?
            </n-button>
          </n-card>

          <n-card
            v-show="step >= 9 && jokeCleared"
            class="v-home__intro"
            title="–¢—ã –≤—Å–µ–≥–¥–∞ –º–æ–∂–µ—à—å –ø—Ä–µ—Ä–≤–∞—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∑–∞–∫—Ä—ã—Ç—å –≤–∫–ª–∞–¥–∫—É, –ø–æ–π—Ç–∏ –ø–æ —Å–≤–æ–∏–º –Ω—É–∂–¥–∞–º, –æ–¥–Ω–∞–∫–æ, –Ω–µ –æ—Ç–∫–ª–∞–¥—ã–≤–∞–π –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ —Ç–µ—Å—Ç–∞ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å, —Ç–∞–π–º–µ—Ä –ø–æ–∫–∞–∂–µ—Ç —Å–∫–æ–ª—å–∫–æ —Ç—ã –≤—Ä–µ–º–µ–Ω–∏ —Ç—ã –∞–∫—Ç–∏–≤–Ω–æ –ø—Ä–æ—Ö–æ–¥–∏–ª(–∞) —Ç–µ—Å—Ç –∏ –æ–±—â–µ–µ –≤—Ä–µ–º—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Å —É—á–µ—Ç–æ–º –≤—Å–µ—Ö –ø–∞—É–∑"
            key="step9"
          >
            <n-button @click="onUpdateStep(10)">
              –ö—É—Ç–∞–∫ –±–∞—à
            </n-button>
          </n-card>

          <n-card
            v-show="step >= 10 && jokeCleared"
            class="v-home__intro"
            title="–≠—ç—ç—ç –±–∏–ª—è—Ç –∞—É–∑—ã–Ω–∞ —è–± –Ω–∞—Ö—É–π"
            key="step10"
          >
            <n-button @click="onUpdateStep(11)">
              ...
            </n-button>
          </n-card>

          <n-card
            v-show="step >= 11 && jokeCleared"
            class="v-home__intro"
            title="–ö—Ö –∫—Ö–º"
            key="step11"
          >
            <n-button @click="onUpdateStep(12)">
              ...
            </n-button>
          </n-card>

          <n-card
            v-show="step >= 12 && jokeCleared"
            class="v-home__intro"
            title="–í–æ–±—â–µ–º, –ø–æ–¥ –∫–æ–Ω–µ—Ü —Ö–æ—á—É –Ω–∞–ø–æ–º–Ω–∏—Ç—å, —á—Ç–æ –∫–∞–∫ —Ç–æ–ª—å–∫–æ –º—ã –∑–∞–∫–æ–Ω—á–∏–º –Ω–∞—à —Ä–∞–∑–≥–æ–≤–æ—Ä, –º—ã –±–æ–ª–µ–µ –Ω–µ –≤—Å—Ç—Ä–µ—Ç–∏–º—Å—è, —Ç—ã –±—É–¥–µ—à—å –æ–¥–∏–Ω –Ω–∞ –æ–¥–∏–Ω —Å –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ–π –±–µ—Å—á–µ–ª–æ–≤–µ—á–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–æ–π, –∫–æ—Ç–æ—Ä–∞—è –∂–¥–µ—Ç –æ—Ç —Ç–µ–±—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤"
            key="step12"
          >
            <n-button @click="onUpdateStep(13)">
              –ë—É–¥–µ–º –ø—Ä–æ—â–∞—Ç—å—Å—è?
            </n-button>
          </n-card>

          <n-card
            v-show="step >= 13 && jokeCleared"
            class="v-home__intro"
            title="–ñ–µ–ª–∞—é —Ç–µ–±–µ —É–¥–∞—á–∏ –≤ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–∏ —Ç–µ—Å—Ç–æ–≤ –∏ —Å–æ–≤–µ—Ç—É—é –Ω–µ –≤–æ–ª–Ω–æ–≤–∞—Ç—å—Å—è –∏ –≤–µ—Ä–∏—Ç—å –≤ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–∏–ª—ã ‚ù§Ô∏è‚Äçüî•!"
            key="step13"
          >
            <n-button @click="onSubmit">
              –ó–∞–∫–æ–Ω—á–∏—Ç—å –¥–∏–∞–ª–æ–≥
            </n-button>
          </n-card>
        </transition-group>
      </div>
    </div>
  </div>
</template>

<style lang="scss">
.v-home {
  height: 100vh;

  padding: 24px;

  overflow-y: auto;

  box-sizing: border-box;

  &__intro:not(:last-child) {
    margin-bottom: 24px;

    transition: all 1s;
  }

  &__content {
    display: flex;
    justify-content: center;
  }

  &__body {
    max-width: 100%;
    max-height: calc(100vh / 2 + 100px);

    width: 420px;

    display: flex;
    flex-direction: column;
    justify-content: end;
  }
}
</style>
